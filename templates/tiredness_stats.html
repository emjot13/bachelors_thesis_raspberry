<!DOCTYPE html>
{% load static %}
<html lang="en">
  <head>
    <title>Example Template</title>
    <script src="{% static 'js/chart.min.js' %}"></script>
    <link rel="stylesheet" type="text/css" href="{% static 'styles.css' %}">



  <style>
    body{
      background-color: rgb(1, 48, 102);
      color: white;
      font-weight: bold;
    }
    button{
      width: 150px;
      font-weight: bold;
      border:black 3px solid;
      background-color: rgb(0, 89, 223);
      border-radius: 10px;
      padding: 5px;
      margin: 5px;
      color: rgb(209, 209, 209);
    }
    button:hover{
      background-color: rgb(1, 102, 255);
      color: white;
    }
    button:active{
      background-color: rgb(0, 72, 179);
    }

  </style>
    <script>
  function createChart() {
  chartData = JSON.parse(JSON.stringify({{chart_data|safe}}));
    var ctx = document.getElementById('myChart').getContext('2d');
    var chart = new Chart(ctx, {
      type: 'line',
      data: chartData,
      options: {
        scales: {
          yAxes: [{
            ticks: {
              beginAtZero: true
            }
          }]
        }
      }
    });
  }
    </script>
  </head>
  <body>
    <h1>{{ message }}</h1>

<form>
  <label for="date-input">Select Start Date:</label>
  <input type="date" id="date-input" name="start_date">
  <label for="end-date-input">Select End Date:</label>
  <input type="date" id="end-date-input" name="end_date">
  <button type="button" id="submit-dates-btn">Submit</button>
  <script>

    var startDateInput = document.getElementById("date-input");
    var endDateInput = document.getElementById("end-date-input");
    var submitDatesBtn = document.getElementById("submit-dates-btn");

submitDatesBtn.addEventListener("click", function() {
var startValue = startDateInput.value;
var endValue = endDateInput.value;
var currentUrl = new URL(window.location.href);
var searchParams = new URLSearchParams(currentUrl.search);
searchParams.delete("start_date");
searchParams.delete("end_date");
searchParams.append("start_date", startValue);
searchParams.append("end_date", endValue);
currentUrl.search = searchParams.toString();
window.location = currentUrl.toString();
});
  </script>
</form>


    <form>
  <label for="time-interval">Select Time Interval:</label>
  <select id="time-interval" name="time-interval">
    <option value="1">1 min</option>
    <option value="5">5 min</option>
    <option value="15" >15 min</option>
    <option value="60">1 hour</option>
  </select>
<script>
  var select = document.getElementById("time-interval");
  select.value = "15";
  select.addEventListener("change", function() {
      var selectedValue = select.value;
    var currentUrl = new URL(window.location.href);
    var searchParams = new URLSearchParams(currentUrl.search);
    searchParams.delete("time_interval");
    searchParams.append("time_interval", selectedValue);
    currentUrl.search = searchParams.toString();
    window.location = currentUrl.toString();
  });
</script>

</form>


    <ul>
<!--      {% for item in items %}-->
<!--      <li>Day: {{ item.day }}, <div>yawns: {{item.yawns}} times</div> <div>closed eyes for prolonged time: {{item.sleep}} times</div></li>-->
<!--      {% endfor %}-->
    </ul>

  <canvas id="myChart"></canvas>
  <script>
  function getParameterByName(name)
{
    name = name.replace(/[\[]/, "\\\[").replace(/[\]]/, "\\\]");
    var regexS = "[\\?&]" + name + "=([^&#]*)";
    var regex = new RegExp(regexS);
    var results = regex.exec(window.location.href);
    if (results == null) return "";
    else return decodeURIComponent(results[1].replace(/\+/g, " "));
}

      var startDateInput = document.getElementById("date-input");
    var endDateInput = document.getElementById("end-date-input");
    startDateInput.value = getParameterByName("start_date");
    endDateInput.value = getParameterByName("end_date");
    var select = document.getElementById("time-interval");
    var timeIntervalValue = getParameterByName("time_interval");
    if (timeIntervalValue) {
      select.value = timeIntervalValue
      }


    </script>
    <script>
  window.addEventListener('load', createChart);
</script>
  </body>
</html>